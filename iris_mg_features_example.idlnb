{
  "version": "2.0.0",
  "cells": [
    {
      "type": "markdown",
      "content": [
        "### Get Mg II Features in IDL",
        "---",
        "Some issues with `iris_get_mg_features` when rebinning IRIS data"
      ],
      "metadata": {},
      "outputs": []
    },
    {
      "type": "code",
      "content": [
        ";load the example dataset ",
        "",
        "restore, \"./rebin_spec_20220317_253_129.sav\", /verbose"
      ],
      "metadata": {},
      "outputs": [
        {
          "items": [
            {
              "mime": "text/plain",
              "content": [
                "% RESTORE: Portable (XDR) SAVE/RESTORE file.",
                "% RESTORE: Save file written by yjzhu@staff-net-vpn-dhcp-7141.intern.ethz.ch,",
                "            Thu Jan 29 13:19:21 2026.",
                "% RESTORE: IDL version 9.0.0 (darwin, x86_64).",
                "% RESTORE: Restored variable: SPEC_EXAMPLE.",
                "% RESTORE: Restored variable: SPEC_REBINNED_EXAMPLE.",
                "% RESTORE: Restored variable: WAVE.",
                "% RESTORE: Restored variable: WAVE_REBINNED.",
                ""
              ]
            }
          ],
          "metadata": {
            "id": "not-saved"
          }
        }
      ]
    },
    {
      "type": "code",
      "content": [
        "; visualize the two spectra around the Mg II k line",
        "",
        "!p.font=1",
        "!p.charsize=2.5"
      ],
      "metadata": {},
      "outputs": []
    },
    {
      "type": "code",
      "content": [
        "plot, [1,2,3]"
      ],
      "metadata": {},
      "outputs": [
        {
          "items": [
            {
              "mime": "idl/notebook-renderer",
              "content": "{\"type\":\"idlnotebookimage_png\",\"item\":{\"xsize\":960,\"ysize\":600,\"data\":\"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AAENAAABAhoAAAIENAAABAhoAAAIENAAABAgoAEAIOC79QVQQSnl5ceXZbn5SgAAzttrG6jDCQMAJpEke9zCAQAAAQIaAAACBDQAAAQIaAAACBDQAAAQIKABACBAQAMAQICABgCAAAENAAABAhoAAAIENAAABAhoAAAIENAAABDw3foCqKCU8vLjy7LcfCUAAOfttQ3U4YQBAJNIkj1u4QAAgAABDQAAAQIaAAACBDQAAAQIaAAACBDQAAAQIKABACBAQAMAQICABgCAAAENAAABAhoAAAIENAAABAhoAAAI+G59AVRQSnn58WVZbr4SAIDz9toG6nDCAIBJJMket3AAAECAgAYAgAABDQAAAQIaAAACBDQAAAQIaAAACBDQAAAQIKABACBAQAMAQICABgCAAAENAAABAhoAAAIENAAABHy3vgAqKKW8/PiyLDdfCQDAeXttA3U4YQDAJJJkj1s4AAAgQEADAECAgAYAgAABDQAAAQIaAAACBDQAAAQIaAAACBDQAAAQIKABACBAQAMAQICABgCAAAENAAABAhoAAAK+W18AFZRSXn58WZabrwQA4Ly9toE6nDAAYBJJssctHAAAECCgAQAgQEADAECAgAYAgAABDQAAAQIaAAACBDQAAAQIaAAACBDQAAAQIKABACBAQAMAQICABgCAAAENAAAB360vgApKKS8/vizLzVcCAHDeXtskIaAzej40n0SwUAYARrLXNknC2i0c6WxORpKDAgDAg4DOZc3lZVnWr700NABAHgI6ozWd3ZsBAJCNgE7ksTRvollDAwCkIqD74C4OruBccYbzw2EOD70T0AAAECCgAQAgQEADAECAgCasyb1r9z/oDI/YxAy/sDM8YhMz/MJO8gR7P7+VwzxiEgK6D96LAwAgCQGdyKOS/SRCAIDMBHRGazS/fGdoAAAaEtC5PP/4btszAEBCps3u6WwAYB7+Zh4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgMkvrC+CNUsrzPy7L+9+yA5/CqJ4Pw9uTsDk5n38iAyulfH4AQueN4T3Og2cePvfyMESP0D0nx+lMbfPs88mT0YFPYUjHDo+jwmp9TQp93f74l0Ofy5A+PwNep1i9fOX6+vN4tMqe/139AJz0fAg2r0wVP4XhOQl8rpRy7EVo/ffF0Mwe58cZIOr3K9SHp6hJ9gjovA789ssjHo79LRg8O3bnxoFPZzx+9zlg+fH5pzTMHgENw3r5NOSrLN6Kvoatn/X7g87bhNQzM/hufQHELMviBYlL+T4woAm3zrOROXgENPDP852LbmQEbrM+2xy+BZ8hpT0GbuEA/rP5i3vfdwjcYHPn6+93YGBC+RccAQ0AJJI5m+BBQHfGV+TcycsYAHfq5R4eAQ3DCr252Pqc9fa/AC95MzsOePnMw7Q6+kZSAZ3Xhz/9y3sm8NsnbyimmDnj7TOPs8Se5yefl99r4fDM7O+30cyTPd6FI7sDP5jn8M/yYTybwxD6mcyffwqD+aNm3v40+KuuiU788WV59PB48pnN4wwc+LusJofH6cxOAHHGga/Uk3xxT48cHg5zeDhM9gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAnP4P6emHEIn8aGIAAAAASUVORK5CYII=\"}}"
            }
          ],
          "metadata": {
            "id": "not-saved"
          }
        }
      ]
    },
    {
      "type": "code",
      "content": [
        "; plot original and rebinned spectra",
        "",
        "cgplot, wave, spec_example, psym=10, $",
        "    xrange=[279.5, 279.8], $",
        "    xtitle=\"Wavelength (nm)\", ytitle=\"Intensity\", $",
        "    color=\"red\"",
        "",
        "cgplot, wave_rebinned, spec_rebinned_example, psym=10, $",
        "    color=\"blue\", /overplot",
        "",
        "al_legend, [\"Original\", \"Rebinned\"], psym=[0, 0], $",
        "    color=[\"red\", \"blue\"], linestyle=[0,0], linsize=0.2, $",
        "    box=0"
      ],
      "metadata": {},
      "outputs": [
        {
          "items": [
            {
              "mime": "idl/notebook-renderer",
              "content": "{\"type\":\"idlnotebookimage_png\",\"item\":{\"xsize\":960,\"ysize\":600,\"data\":\"iVBORw0KGgoAAAANSUhEUgAAA8AAAAJYCAIAAAAi9hhWAAAAA3NCSVQICAjb4U/gAAAgAElEQVR4nO3d65KjOBIGUGuj3/+V2R+e9jAgQMlVSOfExsa0CwNFYfw5nUhpGIYPAABQ5n9P7wAAALyJAA0AAAECNAAABAjQAAAQIEADAECAAA0AAAECNAAABAjQAAAQIEADAECAAA0AAAECNAAABAjQAAAQIEADAECAAA0AAAECNAAABAjQAAAQIEADAECAAA0AAAECNAAABAjQAAAQIEADAECAAA0AAAECNAAABAjQAAAQIEADAECAAA0AAAECNAAABAjQAAAQIEADAECAAA0AAAECNAAABAjQAAAQIEADAECAAA0AAAECNAAABAjQAAAQIEADAECAAA0AAAECNAAABAjQAAAQIEADAECAAA0AAAECNAAABAjQAAAQIEADAECAAA0AAAECNAAABAjQAAAQIEADAECAAA0AAAECNAAABAjQAAAQIEADAECAAA0AAAECNAAABPx5egdeL6X0++9hGB7cEwAAbiBAn0BuBgDohxYOAAAIUIE+wbeLY70OPe70AADoRJNf1AvQJ/ieGSml9VPkxBNoc1uPrOrctVW7Y+euzY49uzY79uza7Niza7Njz66tnx07a1VV0cJx1O8kG4ah1bMEAIAfARoAAAIqauGYl2/3dRXv+95hvY95aay68bOUnwEAelBRgP7MsultXcUr2ff3o19KHofmcXRuskceAICJM/vEj5hn0M1UekqT+28rS5vbsWPX7S27Of7Pcvyf5fg/y/F/luP/rFaPfy090MMwnH58f9Xi9QfXM/r8wSbPAwAACtUSoK8wb02eF49L0nB2GR3PAAB9qjRAl8fTNDL/6ThD61QGAOC4SgP012bY/TbW/No/NjO09Nwtf/pnOf7Pcvyf5fg/y/HnCtUF6MkwFysmbdObY8l5CQEAcFx1Afrrijkkl9o8AACgXEUBurz2vGRlELr1Ng8AAChUS4CezFdSsnx2iLr5P0NtHuv7NqYhBACgTxXNRFgycfdkmfXRubM/CgXf3wQr8z0BAKBPVQTo8TBzEyUDcYSWX3/6UiFcaAYA4Ov18yuOo+11v8vxrbQ6lSUAwJJW808VFegj7vmrNPm3BwBgh9cH6BdZ6gORzgGAV+ut2VWAvo+gDAA0aSnktBqsaxnG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\"}}"
            }
          ],
          "metadata": {
            "id": "not-saved"
          }
        }
      ]
    },
    {
      "type": "code",
      "content": [
        "help, spec_example",
        "help, spec_rebinned_example"
      ],
      "metadata": {},
      "outputs": [
        {
          "items": [
            {
              "mime": "text/plain",
              "content": [
                "SPEC_EXAMPLE    FLOAT     = Array[537]",
                "SPEC_REBINNED_EXAMPLE",
                "                FLOAT     = Array[268]"
              ]
            }
          ],
          "metadata": {
            "id": "not-saved"
          }
        }
      ]
    },
    {
      "type": "code",
      "content": [
        "; lets make the dummy input spectra to 2d arrays",
        "",
        "spec_in = reform(spec_example, n_elements(spec_example), 1)",
        "spec_rebinned_in = reform(spec_rebinned_example, n_elements(spec_rebinned_example), 1)",
        "",
        "vrange = [-40, 40] ;recommended values"
      ],
      "metadata": {},
      "outputs": []
    },
    {
      "type": "code",
      "content": [
        "iris_get_mg_features, spec_in, $",
        "    wave, vrange, lc_onlyk, rp_onlyk, bp_onlyk, /onlyk",
        "",
        "iris_get_mg_features, spec_rebinned_in, $",
        "    wave_rebinned, vrange, lc_rebinned_onlyk, rp_rebinned_onlyk, bp_rebinned_onlyk, /onlyk"
      ],
      "metadata": {},
      "outputs": []
    },
    {
      "type": "code",
      "content": [
        "help, lc_onlyk"
      ],
      "metadata": {},
      "outputs": [
        {
          "items": [
            {
              "mime": "text/plain",
              "content": [
                "LC_ONLYK        FLOAT     = Array[1, 2]",
                ""
              ]
            }
          ],
          "metadata": {
            "id": "not-saved"
          }
        }
      ]
    },
    {
      "type": "code",
      "content": [
        "; the results from the two spectra with /onlyk are completely different!",
        "",
        "print, \"k3 vel\", lc_onlyk[0,0], \" k3 int\", lc_onlyk[0,1]",
        "print, \"k3 vel (rebinned)\", lc_rebinned_onlyk[0,0], \" k3 int (rebinned)\", lc_rebinned_onlyk[0,1]"
      ],
      "metadata": {},
      "outputs": [
        {
          "items": [
            {
              "mime": "text/plain",
              "content": [
                "k3 vel     -7.02760 k3 int      112348.",
                "k3 vel (rebinned)      3.60920 k3 int (rebinned)      199461."
              ]
            }
          ],
          "metadata": {
            "id": "not-saved"
          }
        }
      ]
    },
    {
      "type": "code",
      "content": [
        "print, \"k2v vel\", bp_onlyk[0,0], \" k2v int\", bp_onlyk[0,1]",
        "print, \"k2v vel (rebinned)\", bp_rebinned_onlyk[0,0], \" k2v int (rebinned)\", bp_rebinned_onlyk[0,1]"
      ],
      "metadata": {},
      "outputs": [
        {
          "items": [
            {
              "mime": "text/plain",
              "content": [
                "k2v vel     -10.4109 k2v int      118769.",
                "k2v vel (rebinned)     -29.0384 k2v int (rebinned)      175891."
              ]
            }
          ],
          "metadata": {
            "id": "not-saved"
          }
        }
      ]
    },
    {
      "type": "code",
      "content": [
        "print, \"k2r vel\", rp_onlyk[0,0],  \"k2r int\", rp_onlyk[0,1]",
        "print, \"k2r vel (rebinned)\", rp_rebinned_onlyk[0,0], \" k2r int (rebinned)\", rp_rebinned_onlyk[0,1]"
      ],
      "metadata": {},
      "outputs": [
        {
          "items": [
            {
              "mime": "text/plain",
              "content": [
                "k2r vel      8.03462k2r int      220473.",
                "k2r vel (rebinned)      7.42001 k2r int (rebinned)      213735."
              ]
            }
          ],
          "metadata": {
            "id": "not-saved"
          }
        }
      ]
    },
    {
      "type": "code",
      "content": [
        "; overplot the k3 positions on the spectra",
        "",
        "; hard coded Mg II k3 line centroid in `iris_get_mg_features`",
        "k3_wave = 279.64400000d0",
        "; k3_wave = 279.63509493d0",
        "; speed of light in km/s",
        "c = 299792.458d0",
        "",
        "; with /onlyk option",
        "; it's clear that for the original spectrum, the k2r and k3 positions are off ",
        "; and for the rebinned spectrum, the k3 position is off",
        "",
        "cgplot, wave, spec_example, psym=10, $",
        "    xrange=[279.5, 279.8], $",
        "    xtitle=\"Wavelength (nm)\", ytitle=\"Intensity\", $",
        "    color=\"red\", title=\"Mg II k line features extraction with /onlyk keyword\"",
        "",
        "cgplot, wave_rebinned, spec_rebinned_example, psym=10, $",
        "    color=\"blue\", /overplot",
        "",
        "cgplot, k3_wave + lc_onlyk[0,0]/c*k3_wave, lc_onlyk[0,1], psym=2, $",
        "    color=\"red\", symsize=2, /overplot",
        "",
        "cgplot, k3_wave + bp_onlyk[0,0]/c*k3_wave, bp_onlyk[0,1], psym=5, $",
        "    color=\"red\", symsize=2, /overplot",
        "",
        "cgplot, k3_wave + rp_onlyk[0,0]/c*k3_wave, rp_onlyk[0,1], psym=4, $",
        "    color=\"red\", symsize=2, /overplot",
        "",
        "cgplot, k3_wave + lc_rebinned_onlyk[0,0]/c*k3_wave, lc_rebinned_onlyk[0,1], psym=2, $",
        "    color=\"blue\", symsize=2, /overplot",
        "",
        "cgplot, k3_wave + bp_rebinned_onlyk[0,0]/c*k3_wave, bp_rebinned_onlyk[0,1], psym=5, $",
        "    color=\"blue\", symsize=2, /overplot",
        "",
        "cgplot, k3_wave + rp_rebinned_onlyk[0,0]/c*k3_wave, rp_rebinned_onlyk[0,1], psym=4, $",
        "    color=\"blue\", symsize=2, /overplot",
        "",
        "al_legend, [\"Original\", \"Rebinned\", \"k3\", \"k2v\", \"k2r\"], psym=[0, 0, 2, 5, 4], $",
        "    color=[\"red\", \"blue\", \"red\", \"red\", \"red\"], linestyle=[0,0,0,0,0], linsize=0.2, $",
        "    box=0, symsize=2"
      ],
      "metadata": {},
      "outputs": [
        {
          "items": [
            {
              "mime": "idl/notebook-renderer",
              "content": "{\"type\":\"idlnotebookimage_png\",\"item\":{\"xsize\":960,\"ysize\":600,\"data\":\"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\"}}"
            }
          ],
          "metadata": {
            "id": "not-saved"
          }
        }
      ]
    },
    {
      "type": "code",
      "content": [
        "; without /onlyk option",
        "",
        "iris_get_mg_features, spec_in, $",
        "    wave, vrange, lc, rp, bp",
        "",
        "iris_get_mg_features, spec_rebinned_in, $",
        "    wave_rebinned, vrange, lc_rebinned, rp_rebinned, bp_rebinned",
        ""
      ],
      "metadata": {},
      "outputs": []
    },
    {
      "type": "code",
      "content": [
        "; the results from the two spectra without /onlyk are more or less correct and consistent now!",
        "",
        "k3_wave = 279.63509493d0",
        "",
        "cgplot, wave, spec_example, psym=10, $",
        "    xrange=[279.5, 279.8], $",
        "    xtitle=\"Wavelength (nm)\", ytitle=\"Intensity\", $",
        "    color=\"red\", title=\"Mg II k line features extraction without /onlyk option\"",
        "",
        "cgplot, wave_rebinned, spec_rebinned_example, psym=10, $",
        "    color=\"blue\", /overplot",
        "",
        "cgplot, k3_wave + lc[0,0]/c*k3_wave, lc[0,1], psym=2, $",
        "    color=\"red\", symsize=2, /overplot",
        "",
        "cgplot, k3_wave + bp[0,0]/c*k3_wave, bp[0,1], psym=5, $",
        "    color=\"red\", symsize=2, /overplot",
        "",
        "cgplot, k3_wave + rp[0,0]/c*k3_wave, rp[0,1], psym=4, $",
        "    color=\"red\", symsize=2, /overplot",
        "",
        "cgplot, k3_wave + lc_rebinned[0,0]/c*k3_wave, lc_rebinned[0,1], psym=2, $",
        "    color=\"blue\", symsize=2, /overplot",
        "",
        "cgplot, k3_wave + bp_rebinned[0,0]/c*k3_wave, bp_rebinned[0,1], psym=5, $",
        "    color=\"blue\", symsize=2, /overplot",
        "",
        "cgplot, k3_wave + rp_rebinned[0,0]/c*k3_wave, rp_rebinned[0,1], psym=4, $",
        "    color=\"blue\", symsize=2, /overplot",
        "",
        "al_legend, [\"Original\", \"Rebinned\", \"k3\", \"k2v\", \"k2r\"], psym=[0, 0, 2, 5, 4], $",
        "    color=[\"red\", \"blue\", \"red\", \"red\", \"red\"], linestyle=[0,0,0,0,0], linsize=0.2, $",
        "    box=0, symsize=2"
      ],
      "metadata": {},
      "outputs": [
        {
          "items": [
            {
              "mime": "idl/notebook-renderer",
              "content": "{\"type\":\"idlnotebookimage_png\",\"item\":{\"xsize\":960,\"ysize\":600,\"data\":\"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\"}}"
            }
          ],
          "metadata": {
            "id": "not-saved"
          }
        }
      ]
    }
  ]
}